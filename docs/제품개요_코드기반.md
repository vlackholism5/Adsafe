# 1. 제품 개요 및 사용자 흐름 (코드 기준)

현재 구현된 AdSafe MVP 코드를 기준으로 서류를 정리한 문서입니다.

---

## 1.1 제품 개요

AdSafe는 광고 제작자가 제작 과정에서 규제 리스크를 사전에 인지·학습·조정할 수 있도록 돕는 규제 기반 광고 제작 지원 SaaS이다.

- AdSafe Mode(제작/검수): 문구 입력 → 전처리 → 룰엔진 → 결과 제공 → 이력 저장(재현 가능)
- AduSafe Mode(교육): 학습하기·복습하기 중 선택 → 4지선다 랜덤 10문제 → 즉시 피드백(결과 페이지) → 학습 데이터 저장/진행도

서비스 경계(고정)

- AdSafe는 심의 대행·법적 판정을 하지 않는다.
- "통과/안전" 표현 금지 → "리스크 신호 없음/감지" 등으로 표현한다.
- 결과는 참고용이며 최종 책임은 사용자에게 있음을 고지한다.

---

## 1.2 사용자 역할(Role)

| 역할 | 설명 | 접근 범위 |
| --- | --- | --- |
| User(제작자) | 광고 문구 검수·학습 수행 | AdSafe·AduSafe, 본인 프로젝트/문구/이력 |
| Owner | 워크스페이스 소유자 | Admin 전체, 요금/사용자/정책 |
| Admin | 운영 관리자 | 룰/퀴즈/통계/로그 관리 |
| Editor | 편집 권한 | 프로젝트/문구 편집 + 검수 |
| Viewer | 조회 권한 | 조회만(검수 실행 제한 옵션) |

MVP에서는 단일 사용자·로컬 저장 기준으로 동작하며, 역할별 접근 제어는 추후 확장 대상이다.

---

## 1.3 User App — 핵심 사용자 흐름

A) 로그인/온보딩

- 이메일 로그인(또는 초대 링크 수락은 추후 연동)
- MVP에서는 세션·로컬 저장 기준으로 동작

B) 메인(모드 선택)

- AdSafe Mode / AduSafe Mode 두 가지 진입 카드
- 각 카드 선택 시 해당 모드로 진입

C) AdSafe Mode(제작/검수) — 확정 플로우

1. 사용자가 광고 문구 입력(선택: 광고 유형, 문구 제목)
2. [검수하기] 클릭
3. 시스템 처리
   - 텍스트 전처리(Normalization): 공백·특수기호·문장부호·숫자·대소문자 통일
   - 패턴 매칭 기반 룰엔진 실행(키워드·정규식 + 이벤트 자동 체크 로직)
4. 결과 제공(한 화면 내 섹션/카드로)
   - 리스크 신호 없음/감지(요약 위험도)
   - 적발 항목 리스트(리스크 코드·레벨·매칭 근거·설명)
   - 검수된 문구 영역에서 문제된 표현 하이라이트
5. 수정 → 재검수
6. 검수 이력 저장(재현 가능: 룰 버전/전처리 텍스트/문구 버전, 검수 이력 목록·상세에서 조회)

D) AduSafe Mode(교육) — 확정 플로우

1. 학습하기 또는 복습하기 중 선택
   - 학습하기: 문제 은행에서 랜덤 10문제 추출 후 풀이
   - 복습하기: 이전에 틀린 문항만 재풀이(저장된 내용이 없으면 "복습할 내용이 없습니다" 안내)
2. 4지선다 10문제 제시(1번부터 순차)
3. 답안 선택 후 [다음] 또는 [제출하고 결과 보기] 클릭
4. 10문항 종료 후 결과 페이지에서 즉시 피드백(정오답 + 근거 설명·수정 가이드)
5. 다음 문제/종료
6. 누적 학습 데이터 저장(정답률·숙련도) → 학습 현황 페이지에서 조회, 틀린 문항은 복습하기에서 재풀이 가능

MVP에서는 리스크 카테고리별 선택 없이, 전체 문제 은행에서 랜덤 10문항으로 동작한다.

---

## 1.4 Admin Console — 운영자/관리자 기능 흐름

아래는 서비스 확장 시 목표로 하는 운영·관리 기능 흐름이다. MVP에서는 화면 구조만 존재할 수 있으며, 실제 CRUD·배포는 추후 구현 대상이다.

A) 워크스페이스/사용자 관리

- 워크스페이스 설정(플랜, 상태)
- 사용자 초대·권한 변경·비활성화
- 접근권한 정책(검수 실행 권한, 뷰어 제한 등)

B) 룰엔진 운영(가장 중요)

- 리스크 택소노미(risk_taxonomy) 관리
- 룰셋 버전(rule_set_versions) 릴리즈 관리(draft → active → deprecated)
- 룰(rules) CRUD(버전 단위로 묶임, 삭제 지양)
- 룰 검증(샘플 문구로 룰셋 테스트/시뮬레이션) — 상용 필수

C) 교육(퀴즈) 운영

- 문제은행(quizzes) CRUD
- 보기(quiz_choices) CRUD
- 카테고리·난이도·활성화 관리
- 문제 품질 관리(오답률·혼동률 지표) — 고도화 기능

D) 모니터링/분석

- 검수 실행 트래픽·응답속도·실패율
- 리스크 Top N / 룰 트리거 Top N
- 사용자 학습 성취·정답률

E) 감사/분쟁 대응

- audit_logs 조회(누가·언제·무엇을 변경했는지)
- 룰 변경 이력과 과거 결과 재현성 확보(룰 버전·검수 run 저장)

---

## 1.5 화면 정의(IA 수준)

User App (MVP 기준)

1. 로그인/초대 수락
2. 메인(모드 선택: AdSafe Mode / AduSafe Mode)
3. AdSafe 검수 화면(광고 유형·문구 제목·광고 문구 입력, 검수하기, 결과·하이라이트·적발 항목, 수정·재검수)
4. 검수 이력 목록(실행일시·광고 유형·문구 제목·요약 위험도·적발 건수·상세보기, 페이지네이션)
5. 검수 이력 상세(기본 정보·검수된 문구·결과 요약·상세 리스크 항목·재검수하기)
6. AduSafe 메뉴(학습하기 / 복습하기 선택)
7. AduSafe 퀴즈(문제 번호·지문·4지선다·다음/제출)
8. AduSafe 결과(정답률·학습 내용 정리: 문항별 정오답·근거 설명, 틀린 문제 복습하기·학습 현황·다시 학습하기·학습 메뉴로)
9. 학습 현황(총 퀴즈 횟수·총 풀은 문제 수·총 정답 수·평균 정답률, 최근 학습 이력 테이블, 학습하기·복습하기 링크)

Admin Console (목표 IA, MVP 이후 확장)

1. 워크스페이스 설정
2. 사용자·권한 관리
3. 리스크 택소노미 관리
4. 룰셋 버전 관리(릴리즈)
5. 룰 관리(버전별)
6. 룰 테스트/시뮬레이션(샘플 입력·결과 확인)
7. 퀴즈 문제은행 관리
8. 통계·모니터링
9. 감사 로그 조회
